import org.openhab.model.script.actions.Timer

var Timer timer = null 

rule "Sunset"
when
	Channel 'astro:sun:home:set#event' triggered START
then
    	ItsDark.postUpdate(ON)
	sendNotification("e33b1711@gmail.com", "Its dark.")
	sendCommand(LI_EG_AO, ON)
    	timer = Timer.createTimer(now.plusMinutes(240) [|
        	sendCommand(LI_EG_AO, OFF)
        	timer = null   // reset the timer
    	])
end

rule "Sunrise"
when
	Channel 'astro:sun:home:rise#event' triggered START
then
	ItsDark.postUpdate(OFF)
	sendNotification("e33b1711@gmail.com", "Its not dark.")
end



